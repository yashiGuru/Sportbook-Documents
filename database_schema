# Sportsbook Database Schema

## Overview
This document outlines the improved database schema for the sportsbook application, addressing key issues in the old schema and optimizing for performance, data integrity, and scalability.

## Old Schema Issues
### 1. Data Insert Time Issue
- The primary ID is assigned first, and then foreign keys are set afterward, causing delays and inconsistency.
- Foreign key references are required before the primary key is established, leading to failed or delayed insertions.

### 2. Relation Issues
- The old schema had complex relationships between sports, locations, leagues, fixtures, odds, and markets.
- Foreign keys were not always enforced, resulting in orphaned records and data inconsistency.
- Lack of normalization led to redundancy, performance issues, and difficulties in maintaining referential integrity.

### 3. Extra Fields and Improper Data Types
- Unnecessary fields or incorrect data types affected efficiency.
- Missing the `UNSIGNED` attribute for IDs or status flags led to unexpected values and poor performance.
- Fields did not always align with business logic, making maintenance difficult.

---
## New Schema Design

### 1. Sports
| Field          | Type        | Attributes           |
|---------------|------------|----------------------|
| id            | INT        | Primary Key, AUTO_INCREMENT |
| sportId       | VARCHAR(191) | Unique Identifier |
| name          | VARCHAR(100) | Not NULL |
| icon          | VARCHAR(255) | Optional |
| status        | BOOLEAN    | Not NULL, Default: TRUE |
| created_at    | TIMESTAMP  | Default: CURRENT_TIMESTAMP |
| updated_at    | TIMESTAMP  | Default: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

### 2. Locations
| Field           | Type        | Attributes          |
|----------------|------------|---------------------|
| id             | INT        | Primary Key, AUTO_INCREMENT |
| locationId     | VARCHAR(191) | Unique Identifier |
| name           | VARCHAR(100) | Not NULL |
| countryflagimage | VARCHAR(255) | Optional |
| status         | BOOLEAN    | Not NULL, Default: TRUE |
| created_at     | TIMESTAMP  | Default: CURRENT_TIMESTAMP |
| updated_at     | TIMESTAMP  | Default: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

### 3. Leagues
| Field        | Type        | Attributes          |
|-------------|------------|---------------------|
| id          | INT        | Primary Key, AUTO_INCREMENT |
| leagueId    | VARCHAR(191) | Unique Identifier |
| name        | VARCHAR(100) | Not NULL |
| season      | VARCHAR(50)  | Optional |
| sport_id    | INT        | Foreign Key (Sports) |
| location_id | INT        | Foreign Key (Locations) |
| status      | BOOLEAN    | Not NULL, Default: TRUE |
| created_at  | TIMESTAMP  | Default: CURRENT_TIMESTAMP |
| updated_at  | TIMESTAMP  | Default: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

### 4. Fixtures
| Field                | Type        | Attributes          |
|----------------------|------------|---------------------|
| id                  | INT        | Primary Key, AUTO_INCREMENT |
| fixtureId           | VARCHAR(191) | Unique Identifier |
| name                | VARCHAR(100) | Not NULL |
| total_markets       | INT        | Default: 0 |
| start_date          | DATETIME   | Not NULL |
| end_date            | DATETIME   | NULLABLE |
| is_odds             | BOOLEAN    | Default: FALSE |
| fixtures_status     | VARCHAR(50)  | Not NULL |
| subscription_type   | VARCHAR(50)  | Optional |
| subscription_status | BOOLEAN    | Default: FALSE |
| league_id          | INT        | Foreign Key (Leagues) |
| locations_id       | INT        | Foreign Key (Locations) |
| participants_home_id | INT        | Foreign Key (Participants) |
| participants_away_id | INT        | Foreign Key (Participants) |
| sport_id           | INT        | Foreign Key (Sports) |
| actual_start_date  | DATETIME   | NULLABLE |
| actual_end_date    | DATETIME   | NULLABLE |
| last_updated_date  | TIMESTAMP  | Default: CURRENT_TIMESTAMP |

### 5. Markets
| Field      | Type        | Attributes          |
|-----------|------------|---------------------|
| id        | INT        | Primary Key, AUTO_INCREMENT |
| marketId  | VARCHAR(191) | Unique Identifier |
| name      | VARCHAR(100) | Not NULL |
| status    | BOOLEAN    | Not NULL, Default: TRUE |
| created_at | TIMESTAMP  | Default: CURRENT_TIMESTAMP |
| updated_at | TIMESTAMP  | Default: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

### 6. Odds
| Field             | Type        | Attributes          |
|------------------|------------|---------------------|
| id               | INT        | Primary Key, AUTO_INCREMENT |
| oddId           | VARCHAR(191) | Unique Identifier |
| name            | VARCHAR(100) | Not NULL |
| line            | FLOAT       | Default: 0.0 |
| baseline        | FLOAT       | Default: 0.0 |
| bet_status      | VARCHAR(50)  | Not NULL |
| startprice      | FLOAT       | Default: 0.0 |
| price           | FLOAT       | Default: 0.0 |
| betsettlement_status | VARCHAR(50)  | Not NULL |
| suspension_reason | VARCHAR(255) | Optional |
| fixture_id      | INT        | Foreign Key (Fixtures) |
| market_id       | INT        | Foreign Key (Markets) |
| created_at      | TIMESTAMP  | Default: CURRENT_TIMESTAMP |
| updated_at      | TIMESTAMP  | Default: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

### 7. Live Scores
| Field            | Type        | Attributes          |
|-----------------|------------|---------------------|
| id              | INT        | Primary Key, AUTO_INCREMENT |
| livescoreId     | VARCHAR(191) | Unique Identifier |
| fixture_id      | INT        | Foreign Key (Fixtures) |
| status          | VARCHAR(50)  | Not NULL |
| participant_home_id | INT        | Foreign Key (Participants) |
| home_score      | INT        | Default: 0 |
| participant_away_id | INT        | Foreign Key (Participants) |
| away_score      | INT        | Default: 0 |
| periods         | JSON       | Optional |
| statistics      | JSON       | Optional |
| created_at      | TIMESTAMP  | Default: CURRENT_TIMESTAMP |
| updated_at      | TIMESTAMP  | Default: CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

